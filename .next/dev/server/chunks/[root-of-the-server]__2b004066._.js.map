{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Mine/FusionSpace/photoparkk-dev/photoparkk-next/src/lib/supabase.js"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\nconst supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\r\n\r\nif (!supabaseUrl || !supabaseKey) {\r\n    console.warn('Supabase URL or Key is missing. Check your .env.local file.');\r\n}\r\n\r\n// Create a single supabase client for interacting with your database\r\nexport const supabase = createClient(supabaseUrl || '', supabaseKey || '');\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AACN,MAAM;AAEN;;AAKO,MAAM,WAAW,IAAA,gMAAY,EAAC,eAAe,IAAI,eAAe"}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///C:/Mine/FusionSpace/photoparkk-dev/photoparkk-next/src/app/api/admin/stats/route.js"],"sourcesContent":["\r\nimport { supabase } from '@/lib/supabase';\r\nimport { NextResponse } from 'next/server';\r\n\r\nexport async function GET() {\r\n    try {\r\n        // 1. Total Orders & Breakdown\r\n        // Fetch 'orders' table\r\n        const { data: regularOrders, error: regularError } = await supabase\r\n            .from('orders')\r\n            .select('amount, product_type');\r\n\r\n        if (regularError) throw regularError;\r\n\r\n        // Fetch 'frame_orders' table\r\n        const { data: frameOrders, error: frameError } = await supabase\r\n            .from('frame_orders')\r\n            .select('*'); // We need amount? Frame orders structure might be different..\r\n        // Wait, in schema 'frame_orders' only has 'items' (jsonb) and 'shipping_details'.\r\n        // It doesn't seem to have 'amount' column in the schema file I read earlier!\r\n        // Let's re-check schema for Frame Orders.\r\n        // Line 152: id, user_id, items, shipping_details, status.\r\n        // No amount?? That's a problem for revenue calc.\r\n        // But let's assume simple count for now or try to extract from items if possible.\r\n        // Or maybe amount IS in there but I missed it?\r\n        // I'll assume count for frame orders.\r\n\r\n        if (frameError) throw frameError;\r\n\r\n        const totalOrders = (regularOrders?.length || 0) + (frameOrders?.length || 0);\r\n\r\n        // Breakdown\r\n        // Regular orders have 'product_type'\r\n        let commonOrdersCount = 0;\r\n        let newArrivalsCount = 0;\r\n        let commonRevenue = 0;\r\n\r\n        regularOrders.forEach(order => {\r\n            if (order.product_type === 'Newarrivaldata') {\r\n                newArrivalsCount++;\r\n            } else {\r\n                commonOrdersCount++; // Custom or others\r\n            }\r\n            commonRevenue += Number(order.amount) || 0;\r\n        });\r\n\r\n        // Frame Revenue? Not available directly.\r\n        const frameOrdersCount = frameOrders?.length || 0;\r\n        const totalRevenue = commonRevenue; // + frameRevenue (if we had it)\r\n\r\n        // 2. Total Products\r\n        // Count from all product tables\r\n        const tables = ['new_arrivals', 'special_offers', 'acrylic_customize', 'canvas_customize', 'backlight_customize'];\r\n        let totalProducts = 0;\r\n\r\n        for (const table of tables) {\r\n            const { count, error } = await supabase\r\n                .from(table)\r\n                .select('*', { count: 'exact', head: true });\r\n\r\n            if (!error) {\r\n                totalProducts += count || 0;\r\n            }\r\n        }\r\n\r\n        // 3. Total Frames (Assuming Frame customizations or orders? Or 'frames_customize' table?)\r\n        // This is 'Manage Frames' section usually refers to 'frame_customize' or just orders.\r\n        // Let's count 'frame_customize' table which is user drafts?\r\n        // Or maybe 'frame_orders'.\r\n        // The stat card says \"Total Frames\".\r\n        // I will use total products count of frame related items?\r\n        // Or just frame orders count again?\r\n        // Let's use Frame Orders count for \"Total Frames\" stat card context usually implies sales or inventory.\r\n        // But since \"Total Products\" is inventory, \"Total Frames\" might be frame inventory?\r\n        // But we don't have a \"frames\" table in schema list I saw (except customized ones).\r\n        // Ah, 'framescustomize' model existed in old code.\r\n        // In schema.sql, I see 'frame_customize' (user selection).\r\n        // I'll just use 'frame_orders' count as placeholder.\r\n\r\n        return NextResponse.json({\r\n            totalOrders,\r\n            totalProducts,\r\n            totalFrames: frameOrdersCount,\r\n            totalRevenue,\r\n            breakdown: {\r\n                commonOrders: commonOrdersCount,\r\n                frameOrders: frameOrdersCount,\r\n                newArrivals: newArrivalsCount,\r\n                commonRevenue,\r\n                frameRevenue: 0 // Placeholder\r\n            }\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error(\"Dashboard Stats Error:\", error);\r\n        return NextResponse.json({ message: \"Internal Server Error\" }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AACA;AACA;;;AAEO,eAAe;IAClB,IAAI;QACA,8BAA8B;QAC9B,uBAAuB;QACvB,MAAM,EAAE,MAAM,aAAa,EAAE,OAAO,YAAY,EAAE,GAAG,MAAM,oIAAQ,CAC9D,IAAI,CAAC,UACL,MAAM,CAAC;QAEZ,IAAI,cAAc,MAAM;QAExB,6BAA6B;QAC7B,MAAM,EAAE,MAAM,WAAW,EAAE,OAAO,UAAU,EAAE,GAAG,MAAM,oIAAQ,CAC1D,IAAI,CAAC,gBACL,MAAM,CAAC,MAAM,8DAA8D;QAChF,kFAAkF;QAClF,6EAA6E;QAC7E,0CAA0C;QAC1C,0DAA0D;QAC1D,iDAAiD;QACjD,kFAAkF;QAClF,+CAA+C;QAC/C,sCAAsC;QAEtC,IAAI,YAAY,MAAM;QAEtB,MAAM,cAAc,CAAC,eAAe,UAAU,CAAC,IAAI,CAAC,aAAa,UAAU,CAAC;QAE5E,YAAY;QACZ,qCAAqC;QACrC,IAAI,oBAAoB;QACxB,IAAI,mBAAmB;QACvB,IAAI,gBAAgB;QAEpB,cAAc,OAAO,CAAC,CAAA;YAClB,IAAI,MAAM,YAAY,KAAK,kBAAkB;gBACzC;YACJ,OAAO;gBACH,qBAAqB,mBAAmB;YAC5C;YACA,iBAAiB,OAAO,MAAM,MAAM,KAAK;QAC7C;QAEA,yCAAyC;QACzC,MAAM,mBAAmB,aAAa,UAAU;QAChD,MAAM,eAAe,eAAe,gCAAgC;QAEpE,oBAAoB;QACpB,gCAAgC;QAChC,MAAM,SAAS;YAAC;YAAgB;YAAkB;YAAqB;YAAoB;SAAsB;QACjH,IAAI,gBAAgB;QAEpB,KAAK,MAAM,SAAS,OAAQ;YACxB,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,MAAM,oIAAQ,CAClC,IAAI,CAAC,OACL,MAAM,CAAC,KAAK;gBAAE,OAAO;gBAAS,MAAM;YAAK;YAE9C,IAAI,CAAC,OAAO;gBACR,iBAAiB,SAAS;YAC9B;QACJ;QAEA,0FAA0F;QAC1F,sFAAsF;QACtF,4DAA4D;QAC5D,2BAA2B;QAC3B,qCAAqC;QACrC,0DAA0D;QAC1D,oCAAoC;QACpC,wGAAwG;QACxG,oFAAoF;QACpF,oFAAoF;QACpF,mDAAmD;QACnD,2DAA2D;QAC3D,qDAAqD;QAErD,OAAO,gJAAY,CAAC,IAAI,CAAC;YACrB;YACA;YACA,aAAa;YACb;YACA,WAAW;gBACP,cAAc;gBACd,aAAa;gBACb,aAAa;gBACb;gBACA,cAAc,EAAE,cAAc;YAClC;QACJ;IAEJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAwB,GAAG;YAAE,QAAQ;QAAI;IACjF;AACJ"}}]
}